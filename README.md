> 说明：
>
> 1. 介绍常用的设计模式，针对每个设计模式增加实例进行说明。
> 2. 开源是方便自己进行查看。

# 简单工厂模式

基本概念

- 面向对象编程具有三个有点：封装，多态，可继承
- 工厂：用一个单独的类A来创建要实例化的类。这个类A称为工厂。
- UML类图

实例应用

- 使用面向对象的方式编写一个计算器
- 除完成基本的加减乘除运算，可以方便添加开方等操作运算

实现

- 建立一个操作类`Operation`，添加两个基本属性；并将返回结果方法`getResult`定义为抽象方法。
- 针对不同的运算操作各自新建一个类；并继承`Operation`类，对`getResult`方法体进行具体实现
- 新建一个工厂类，该工厂返回一个`Operation`

UML类图理解

![UML类图](https://github.com/iswyq/GOF/blob/master/img/UML%E7%B1%BB%E5%9B%BE.jpg)

- 类图分三层，第一层显示类的名称，如果是抽象类，则就用斜体显示。第二层是类的特性，通常就是字段和属性。第三层是类的操作，通常是方法或行为。

- ‘+’表示public，‘-’表示private，‘#’表示protected
- \<\<interface>>表示接口。接口还有另一种表示方法，俗称棒棒糖表示法
- 空心△+实线表示继承
- 实线箭头表示关联。如企鹅与气候有关，那么企鹅类中可以包含气候对象
- 空心◇+实线箭头表示拥有。如雁群包含大雁
- 实心◇+实线箭头表示合成。如翅膀组合成了鸟
- 虚线箭头表示依赖关系

# 策略模式

策略模式与工厂模式

- 策略模式针对的是不同的算法和实现。
- 工厂模式针对的是对象层面，可以将两者结合起来使用。
- 通过不同的策略(使用文字描述策略)产生不同的处理对象。

![](https://github.com/iswyq/GOF/blob/master/img/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F.jpg)

实际应用

- 根据要求，完成最简单的商场结算计费。
- 考虑到商场不同的促销价格，如打折促销，满减促销
- 对比工厂模式，简单策略模式，策略模式与简单工厂结合

实现

- 建立`CashSuper`类，用来描述现金收费；在其中添加抽象方法acceptCash
- 分别对应三种策略建立`CashNormal|CashRebate|CashReturn`类，用来描述无促销，打折，满减优惠
- 建立`CashContext`类，用来维护不同的策略。根据传入的策略字符串返回执行对应策略的对象
- 建立客户端，需要指定原始金额，促销策略；得到对应策略的对象执行方法，输出需要支付的金额

点评

- 改进后的CashContext承担了策略和工厂的作用。客户只需要指定不同策略对应的对象`CashContext`；只需要传递一个`String type`，用来描述使用何种策略。**简单工厂不一定是一个单独的类**
- 改进前的CashContext只负责策略，执行不同的促销策略需要客户来指定所使用的类。需要知道`CashContext对象`和`CashNormal|CashReturn|CashRebate`.(这样其实就相当于返回到最原始的方式了)

- 结合工厂模式，易出现针对不同的促销方案设计不同的之类的情况。应该注意到，打折和满减可视为两种基本的方案，剩下的就是`折扣数`和`满减门槛`的问题。(<font color='red'>面向对象的编程，并不是类越多越好，类的划分是为了封装，但分类的基础是抽象，具有相同属性和功能的对象的抽象集合才是类</font>)
- 只有两种基本的促销方案，可以考虑使用策略模式；具体的不同促销方案都是在这两种基本下的具体实现。
- 使用策略模式需要注意维护的是哪个对象，并与工厂模式产生的对象加以区分
